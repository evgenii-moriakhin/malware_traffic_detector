from scapy.all import *
import random

from scapy.layers.inet import IP, TCP


def generate_syn_packet(dst_ip, dst_port):
    src_ip = "192.168.1.%d" % random.randint(1, 254)
    src_port = random.randint(1024, 65535)
    ip = IP(src=src_ip, dst=dst_ip)
    syn = TCP(sport=src_port, dport=dst_port, flags="S")
    packet = ip / syn
    return packet

def send_syn_packets(dst_ip, dst_port, count):
    for _ in range(count):
        packet = generate_syn_packet(dst_ip, dst_port)
        send(packet, verbose=0)

if __name__ == "__main__":
    dst_ip = "192.168.1.34"
    dst_port = 80
    count = 1000

    send_syn_packets(dst_ip, dst_port, count)

    print(f"Sent {count} benign SYN packets to {dst_ip}:{dst_port}")