SELECT
    date_trunc('minute', TO_TIMESTAMP(CAST(bidirectional_first_seen_ms / 1000.0 AS bigint))) AS time,
    prediction AS label,
    COUNT(*) as pps
FROM
    public.packages
WHERE
    bidirectional_first_seen_ms BETWEEN CAST($__unixEpochFrom() * 1000.0 AS bigint) AND CAST($__unixEpochTo() * 1000.0 AS bigint)
GROUP BY
    time, label
ORDER BY
    time, label